# Ultrasonic Follow Carrier

## 1介绍
**本项目为2021-2022学年第二学期电气工程学院2020级卓越班嵌入式系统与智能设计课程设计：超声波跟随载物平台之树莓派端。**
根据设计，树莓派为载物平台驱动核心，运行Python语言代码，驱动传感器与电机。

## 2结构

### 2.1 文件结构
```Python
.
┣━ main.py         #主程序，包含控制全流程
┣━ motor_test.py   #电机驱动测试程序(非关键程序，可删除)
┗━ motor.py        #电机底层驱动(main.py讲调用此文件，务必将其与main.py放在同一文件夹内)
```

### 2.2 程序结构

程序流程如下所示:

**┌>调用串口-><br>
│使能传感器-><br>
│获取初始回传数据-><br>
│循环读取传感器数据-><br>
│[根据传感器原始数据计算目标相对位置->]<br>
│使用PID算法调控电机 ─┐<br>
 └───────────────┘**

## 3驱动

### 3.1 传感器驱动
根据设计，传感器与上位机间通讯协议为串口通信，参数115200+8n1，通信数据为字符串格式，以```'s'```作为开始，以```'e'```作为结束。<br>
相关通信指令如下:<br>
1. hello:发送数据```"shelloe"```，使能传感器，使其开始传输数据。此时传感器正常回报```"shelloe"```，否则无输出。
2. test:接受数据```"steste"```，此时上位机收到后可以自行处理，无回报。
3. x in range(0,10):发送数据
```"sxe"```，其中```x```代表错误号以便于排查问题。
4. 传感器数据回报格式:```"s"```->```数据```->```"e"```；回报顺序:……忘了

### 3.2 电机驱动
| en | in1 | in2 | Effect(效果) |
|:-----:|:-----:|:-----:|:-----:|
| 0 | x | x | 空 |
| 1 | 0 | 0 | 空 |
| 1 | 0 | 1 | 反 |
| 1 | 1 | 0 | 正 |
| 1 | 1 | 1 | 制动 |

